{% extends 'base.html' %}
{% load static %}
{% block title %}–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: {{ tournament.name }}{% endblock %}

{% block content %}
<!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
<div class="bg-gray-900 border-b border-gray-800">
    <div class="container mx-auto px-4 py-4">
        <nav class="flex items-center gap-2 text-sm">
            <a href="{% url 'tournament:list' %}" class="text-gray-400 hover:text-white">–¢—É—Ä–Ω–∏—Ä—ã</a>
            <span class="text-gray-600">/</span>
            <a href="{% url 'tournament:detail' tournament.id %}" class="text-gray-400 hover:text-white">
                {{ tournament.name }}
            </a>
            <span class="text-gray-600">/</span>
            <span class="text-white">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span>
        </nav>
    </div>
</div>

<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
<div class="bg-gradient-to-r from-blue-900 to-blue-700">
    <div class="container mx-auto px-4 py-12">
        <h1 class="text-4xl font-bold text-white mb-4">üïê –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞</h1>
        <p class="text-blue-200 text-lg">{{ tournament.name }} ‚Ä¢ {{ tournament.date|date:"d.m.Y" }}</p>
    </div>
</div>

<!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
<div class="container mx-auto px-4 py-8">
    
    {% if mats %}
    <!-- –°–µ—Ç–∫–∞ –º–∞—Ç–æ–≤ -->
    <div class="grid lg:grid-cols-3 gap-6 mb-8">
        {% for mat_number, schedules in mats.items %}
        <div class="bg-gray-900 border border-gray-800 rounded-lg overflow-hidden">
            
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –º–∞—Ç–∞ -->
            <div class="bg-gradient-to-r from-blue-900 to-blue-700 p-4 text-center">
                <h2 class="text-2xl font-bold text-white">–ú–ê–¢ {{ mat_number }}</h2>
                <p class="text-blue-200 text-sm mt-1">{{ schedules|length }} –±–æ—ë–≤</p>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ –±–æ—ë–≤ –Ω–∞ –º–∞—Ç–µ -->
            <div class="p-4 space-y-3 max-h-[600px] overflow-y-auto">
                {% for schedule in schedules %}
                <div class="bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-blue-500 transition">
                    
                    <!-- –í—Ä–µ–º—è –∏ —Å—Ç–∞—Ç—É—Å -->
                    <div class="flex justify-between items-center mb-3">
                        <div>
                            <span class="bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded block mb-1">
                                {{ schedule.scheduled_time|date:"d.m.Y" }}
                            </span>
                            <span class="text-blue-400 text-sm font-semibold">
                                {{ schedule.scheduled_time|date:"H:i" }}
                            </span>
                        </div>
                        <div>
                            {% if schedule.is_finished %}
                            <span class="bg-gray-600 text-white text-xs px-2 py-1 rounded-full">
                                ‚úì –ó–∞–≤–µ—Ä—à—ë–Ω
                            </span>
                            {% elif schedule.is_started %}
                            <span class="bg-green-500 text-white text-xs px-2 py-1 rounded-full animate-pulse">
                                ‚ñ∂ –ò–¥—ë—Ç
                            </span>
                            {% else %}
                            <span class="bg-blue-500 text-white text-xs px-2 py-1 rounded-full">
                                ‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è
                            </span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ–µ -->
                    <div class="mb-2">
                        <p class="text-xs text-gray-500 mb-1">
                            –ë–æ–π #{{ schedule.match.match_number }} ‚Ä¢ {{ schedule.match.get_round_display }}
                        </p>
                        <p class="text-xs text-gray-400 mb-2">
                            {{ schedule.match.grid.category.name }}
                        </p>
                    </div>
                    
                    <!-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ -->
                    <div class="space-y-2">
                        <!-- –ü–µ—Ä–≤—ã–π —Å–ø–æ—Ä—Ç—Å–º–µ–Ω -->
                        <div class="flex items-center justify-between bg-gray-700 rounded p-2">
                            <span class="text-white text-sm font-medium truncate">
                                {{ schedule.match.athlete1.last_name }}
                            </span>
                            {% if schedule.match.is_completed %}
                            <span class="text-lg font-bold {% if schedule.match.winner == schedule.match.athlete1 %}text-green-400{% else %}text-gray-500{% endif %}">
                                {{ schedule.match.score_athlete1 }}
                            </span>
                            {% endif %}
                        </div>
                        
                        <div class="text-center text-xs text-gray-600">vs</div>
                        
                        <!-- –í—Ç–æ—Ä–æ–π —Å–ø–æ—Ä—Ç—Å–º–µ–Ω -->
                        <div class="flex items-center justify-between bg-gray-700 rounded p-2">
                            <span class="text-white text-sm font-medium truncate">
                                {% if schedule.match.athlete2 %}
                                    {{ schedule.match.athlete2.last_name }}
                                {% else %}
                                    <span class="italic text-gray-500">TBD</span>
                                {% endif %}
                            </span>
                            {% if schedule.match.is_completed %}
                            <span class="text-lg font-bold {% if schedule.match.winner == schedule.match.athlete2 %}text-green-400{% else %}text-gray-500{% endif %}">
                                {{ schedule.match.score_athlete2 }}
                            </span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
                    {% if schedule.match.is_completed %}
                    <div class="mt-3 pt-3 border-t border-gray-700">
                        <p class="text-xs text-green-400 font-medium">
                            –ü–æ–±–µ–¥–∏—Ç–µ–ª—å: {{ schedule.match.winner.last_name }}
                        </p>
                        {% if schedule.match.result_type %}
                        <p class="text-xs text-gray-500 mt-1">
                            {{ schedule.match.get_result_type_display }}
                        </p>
                        {% endif %}
                    </div>
                    {% endif %}
                    
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
    
    <!-- –õ–µ–≥–µ–Ω–¥–∞ -->
    <div class="bg-gray-900 border border-gray-800 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-white mb-4">–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤</h3>
        <div class="flex flex-wrap gap-6 text-sm">
            <div class="flex items-center gap-2">
                <span class="bg-blue-500 text-white text-xs px-3 py-1 rounded-full">‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è</span>
                <span class="text-gray-400">–ë–æ–π –µ—â—ë –Ω–µ –Ω–∞—á–∞–ª—Å—è</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="bg-green-500 text-white text-xs px-3 py-1 rounded-full">‚ñ∂ –ò–¥—ë—Ç</span>
                <span class="text-gray-400">–ë–æ–π –∏–¥—ë—Ç —Å–µ–π—á–∞—Å</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="bg-gray-600 text-white text-xs px-3 py-1 rounded-full">‚úì –ó–∞–≤–µ—Ä—à—ë–Ω</span>
                <span class="text-gray-400">–ë–æ–π –∑–∞–≤–µ—Ä—à—ë–Ω</span>
            </div>
        </div>
    </div>
    
    {% else %}
    <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
    <div class="bg-gray-900 border border-gray-800 rounded-lg p-16 text-center">
        <div class="text-6xl mb-4 opacity-50">üïê</div>
        <h3 class="text-2xl font-bold text-white mb-2">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–æ</h3>
        <p class="text-gray-400">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ—è–≤–∏—Ç—Å—è –±–ª–∏–∂–µ –∫ –¥–∞—Ç–µ —Ç—É—Ä–Ω–∏—Ä–∞</p>
    </div>
    {% endif %}
    
    <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
    <div class="mt-8">
        <a href="{% url 'tournament:detail' tournament.id %}" 
           class="inline-flex items-center gap-2 px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition">
            ‚Üê –ù–∞–∑–∞–¥ –∫ —Ç—É—Ä–Ω–∏—Ä—É
        </a>
    </div>
</div>
{% endblock %}
